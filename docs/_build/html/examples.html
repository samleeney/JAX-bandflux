

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Examples &mdash; JAX-bandflux 0.1.91 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=3741d27b" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=8e1ed48b"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Comprehensive Guide to Deploying JAX-bandflux Documentation on ReadTheDocs" href="readthedocs_deployment_guide.html" />
    <link rel="prev" title="Constants Module" href="api/constants.html" />
 
<style>
  /* Custom styles */
  .wy-nav-content {
    max-width: 1000px !important;
  }
  
  /* Improve code block styling */
  div.highlight {
    background-color: #f8f8f8;
  }
  
  /* Improve table styling */
  table.docutils {
    width: 100%;
    margin-bottom: 1em;
  }
  
  table.docutils td, table.docutils th {
    padding: 8px;
  }
  
  /* Improve heading styling */
  h1, h2, h3, h4, h5, h6 {
    margin-top: 1.5em;
    margin-bottom: 0.5em;
  }
  
  /* Improve link styling */
  a.reference {
    border-bottom: 1px dotted #3091d1;
  }
  
  a.reference:hover {
    border-bottom: 1px solid #3091d1;
  }
</style>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            JAX-bandflux
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="core_concepts.html">Core Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">API Reference</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#optimization-with-l-bfgs-b">Optimization with L-BFGS-B</a></li>
<li class="toctree-l2"><a class="reference internal" href="#nested-sampling">Nested Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#anomaly-detection">Anomaly Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotting-light-curves">Plotting Light Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="#comparing-models">Comparing Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#custom-bandpasses">Custom Bandpasses</a></li>
<li class="toctree-l2"><a class="reference internal" href="#working-with-multiple-supernovae">Working with Multiple Supernovae</a></li>
<li class="toctree-l2"><a class="reference internal" href="#jax-optimization-techniques">JAX Optimization Techniques</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="readthedocs_deployment_guide.html">Comprehensive Guide to Deploying JAX-bandflux Documentation on ReadTheDocs</a></li>
<li class="toctree-l1"><a class="reference internal" href="readthedocs_visual_guide.html">ReadTheDocs Visual Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="readthedocs_troubleshooting.html">ReadTheDocs Troubleshooting Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">JAX-bandflux</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Examples</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/examples.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h1>
<p>This page provides examples of how to use JAX-bandflux for various tasks related to supernova light curve modeling. Each example includes a description, code snippets, and expected outputs.</p>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#optimization-with-l-bfgs-b" id="id1">Optimization with L-BFGS-B</a></p></li>
<li><p><a class="reference internal" href="#nested-sampling" id="id2">Nested Sampling</a></p></li>
<li><p><a class="reference internal" href="#anomaly-detection" id="id3">Anomaly Detection</a></p></li>
<li><p><a class="reference internal" href="#plotting-light-curves" id="id4">Plotting Light Curves</a></p></li>
<li><p><a class="reference internal" href="#comparing-models" id="id5">Comparing Models</a></p></li>
<li><p><a class="reference internal" href="#custom-bandpasses" id="id6">Custom Bandpasses</a></p></li>
<li><p><a class="reference internal" href="#working-with-multiple-supernovae" id="id7">Working with Multiple Supernovae</a></p></li>
<li><p><a class="reference internal" href="#jax-optimization-techniques" id="id8">JAX Optimization Techniques</a></p></li>
</ul>
</nav>
<section id="optimization-with-l-bfgs-b">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Optimization with L-BFGS-B</a><a class="headerlink" href="#optimization-with-l-bfgs-b" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">fmin_bfgs.py</span></code> example demonstrates how to use the L-BFGS-B optimization algorithm to fit SALT3 parameters to supernova light curve data.</p>
<p><strong>Running the Example:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download and run the example script</span>
wget<span class="w"> </span>https://raw.githubusercontent.com/samleeney/JAX-bandflux/master/examples/fmin_bfgs.py
python<span class="w"> </span>fmin_bfgs.py
</pre></div>
</div>
<p><strong>What This Example Does:</strong></p>
<ol class="arabic simple">
<li><p>Loads supernova light curve data for SN 19dwz</p></li>
<li><p>Registers bandpasses automatically</p></li>
<li><p>Defines an objective function based on chi-squared</p></li>
<li><p>Uses L-BFGS-B to find the best-fit SALT3 parameters</p></li>
</ol>
<p><strong>Key Code Sections:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the objective function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">objective</span><span class="p">(</span><span class="n">parameters</span><span class="p">):</span>
    <span class="c1"># Create parameter dictionary</span>
    <span class="n">param_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="n">fixed_z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="c1"># Fixed redshift</span>
        <span class="s1">&#39;t0&#39;</span><span class="p">:</span> <span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;x0&#39;</span><span class="p">:</span> <span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="c1"># Calculate model fluxes</span>
    <span class="n">model_fluxes</span> <span class="o">=</span> <span class="n">optimized_salt3_multiband_flux</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span> <span class="n">bridges</span><span class="p">,</span> <span class="n">param_dict</span><span class="p">,</span> <span class="n">zps</span><span class="o">=</span><span class="n">zps</span><span class="p">,</span> <span class="n">zpsys</span><span class="o">=</span><span class="s1">&#39;ab&#39;</span>
    <span class="p">)</span>
    <span class="n">model_fluxes</span> <span class="o">=</span> <span class="n">model_fluxes</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)),</span> <span class="n">band_indices</span><span class="p">]</span>

    <span class="c1"># Calculate chi-squared</span>
    <span class="n">chi2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">fluxes</span> <span class="o">-</span> <span class="n">model_fluxes</span><span class="p">)</span> <span class="o">/</span> <span class="n">fluxerrs</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">chi2</span>
</pre></div>
</div>
<p><strong>Expected Output:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Optimization successful: True
Number of function evaluations: 87

Best-fit parameters:
         z = 0.152300 (fixed)
        t0 = 58651.234567
        x0 = 1.234567e-05
        x1 = 0.987654
         c = 0.123456

Final chi-squared: 123.45
</pre></div>
</div>
</section>
<section id="nested-sampling">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Nested Sampling</a><a class="headerlink" href="#nested-sampling" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">ns.py</span></code> and <code class="docutils literal notranslate"><span class="pre">ns.ipynb</span></code> examples demonstrate how to use nested sampling for Bayesian inference of SALT3 parameters. This approach provides not only parameter estimates but also uncertainties and correlations.</p>
<p><strong>Running the Example:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download and run the example script</span>
wget<span class="w"> </span>https://raw.githubusercontent.com/samleeney/JAX-bandflux/master/examples/ns.py
python<span class="w"> </span>ns.py
</pre></div>
</div>
<p><strong>What This Example Does:</strong></p>
<ol class="arabic simple">
<li><p>Loads supernova light curve data</p></li>
<li><p>Registers bandpasses</p></li>
<li><p>Defines a likelihood function and prior distributions</p></li>
<li><p>Uses nested sampling to sample the posterior distribution of SALT3 parameters</p></li>
<li><p>Visualizes the results using corner plots</p></li>
</ol>
<p><strong>Key Code Sections:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define prior distributions</span>
<span class="n">prior_dists</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;t0&#39;</span><span class="p">:</span> <span class="n">distrax</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">58500.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">58700.0</span><span class="p">),</span>
    <span class="s1">&#39;x0&#39;</span><span class="p">:</span> <span class="n">distrax</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">),</span>
    <span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="n">distrax</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">3.0</span><span class="p">),</span>
    <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="n">distrax</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Define log-likelihood function</span>
<span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_loglikelihood</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="c1"># Convert parameters to dictionary</span>
    <span class="n">param_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="n">fixed_z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;t0&#39;</span><span class="p">:</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;x0&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="o">**</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># log parameterization</span>
        <span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="n">params</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="c1"># Calculate model fluxes</span>
    <span class="n">model_fluxes</span> <span class="o">=</span> <span class="n">optimized_salt3_multiband_flux</span><span class="p">(</span>
        <span class="n">times</span><span class="p">,</span> <span class="n">bridges</span><span class="p">,</span> <span class="n">param_dict</span><span class="p">,</span> <span class="n">zps</span><span class="o">=</span><span class="n">zps</span><span class="p">,</span> <span class="n">zpsys</span><span class="o">=</span><span class="s1">&#39;ab&#39;</span>
    <span class="p">)</span>
    <span class="n">model_fluxes</span> <span class="o">=</span> <span class="n">model_fluxes</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)),</span> <span class="n">band_indices</span><span class="p">]</span>

    <span class="c1"># Calculate log-likelihood (Gaussian)</span>
    <span class="n">log_likelihood</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
        <span class="p">((</span><span class="n">fluxes</span> <span class="o">-</span> <span class="n">model_fluxes</span><span class="p">)</span> <span class="o">/</span> <span class="n">fluxerrs</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fluxerrs</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">log_likelihood</span>
</pre></div>
</div>
</section>
<section id="anomaly-detection">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Anomaly Detection</a><a class="headerlink" href="#anomaly-detection" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">ns_anomaly.py</span></code> example demonstrates how to use nested sampling for anomaly detection in supernova light curves. This approach can identify supernovae that don’t fit the standard SALT3 model well.</p>
<p><strong>Running the Example:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download and run the example script</span>
wget<span class="w"> </span>https://raw.githubusercontent.com/samleeney/JAX-bandflux/master/examples/ns_anomaly.py
python<span class="w"> </span>ns_anomaly.py
</pre></div>
</div>
<p><strong>What This Example Does:</strong></p>
<ol class="arabic simple">
<li><p>Loads supernova light curve data</p></li>
<li><p>Registers bandpasses</p></li>
<li><p>Defines a likelihood function and prior</p></li>
<li><p>Uses nested sampling to sample the posterior distribution of SALT3 parameters</p></li>
<li><p>Identifies anomalies based on the evidence ratio between the SALT3 model and a more flexible model</p></li>
</ol>
<p><strong>Key Concept: Evidence Ratio</strong></p>
<p>The evidence ratio (Bayes factor) between two models is calculated as:</p>
<div class="math notranslate nohighlight">
\[R = \frac{P(D|M_1)}{P(D|M_2)}\]</div>
<p>Where:
* <span class="math notranslate nohighlight">\(P(D|M_1)\)</span> is the evidence for the SALT3 model
* <span class="math notranslate nohighlight">\(P(D|M_2)\)</span> is the evidence for a more flexible model</p>
<p>A low evidence ratio indicates that the supernova is not well-described by the SALT3 model.</p>
<p><strong>Applications:</strong></p>
<ul class="simple">
<li><p>Identifying peculiar supernovae</p></li>
<li><p>Quality control for cosmological analyses</p></li>
<li><p>Discovery of new supernova subtypes</p></li>
</ul>
</section>
<section id="plotting-light-curves">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Plotting Light Curves</a><a class="headerlink" href="#plotting-light-curves" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">plot_light_curve.py</span></code> example demonstrates how to plot supernova light curves with JAX-bandflux. This is useful for visualizing the data and model fits.</p>
<p><strong>Running the Example:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download and run the example script</span>
wget<span class="w"> </span>https://raw.githubusercontent.com/samleeney/JAX-bandflux/master/examples/plot_light_curve.py
python<span class="w"> </span>plot_light_curve.py
</pre></div>
</div>
<p><strong>What This Example Does:</strong></p>
<ol class="arabic simple">
<li><p>Loads supernova light curve data</p></li>
<li><p>Registers bandpasses</p></li>
<li><p>Computes model fluxes using the SALT3 model</p></li>
<li><p>Plots the observed and model light curves</p></li>
</ol>
<p><strong>Key Code Sections:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jax_supernovae.salt3</span><span class="w"> </span><span class="kn">import</span> <span class="n">optimized_salt3_multiband_flux</span>

<span class="c1"># Calculate model fluxes</span>
<span class="n">model_fluxes</span> <span class="o">=</span> <span class="n">optimized_salt3_multiband_flux</span><span class="p">(</span>
    <span class="n">times</span><span class="p">,</span> <span class="n">bridges</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">zps</span><span class="o">=</span><span class="n">zps</span><span class="p">,</span> <span class="n">zpsys</span><span class="o">=</span><span class="s1">&#39;ab&#39;</span>
<span class="p">)</span>
<span class="n">model_fluxes</span> <span class="o">=</span> <span class="n">model_fluxes</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)),</span> <span class="n">band_indices</span><span class="p">]</span>

<span class="c1"># Plot the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Get unique bands</span>
<span class="n">unique_bands</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">band_indices</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">tab10</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_bands</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">band_idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unique_bands</span><span class="p">):</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">band_indices</span> <span class="o">==</span> <span class="n">band_idx</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
        <span class="n">times</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">-</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">],</span>
        <span class="n">fluxes</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span>
        <span class="n">yerr</span><span class="o">=</span><span class="n">fluxerrs</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span>
        <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Band </span><span class="si">{</span><span class="n">band_idx</span><span class="si">}</span><span class="s1"> (Observed)&#39;</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">times</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">-</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;t0&#39;</span><span class="p">],</span>
        <span class="n">model_fluxes</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span>
        <span class="s1">&#39;-&#39;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Band </span><span class="si">{</span><span class="n">band_idx</span><span class="si">}</span><span class="s1"> (Model)&#39;</span>
    <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="comparing-models">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Comparing Models</a><a class="headerlink" href="#comparing-models" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">plot_comparison.py</span></code> example demonstrates how to compare different supernova models, such as SALT3 and SALT3-NIR. This is useful for understanding the differences between models and their impact on parameter estimation.</p>
<p><strong>Running the Example:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download and run the example script</span>
wget<span class="w"> </span>https://raw.githubusercontent.com/samleeney/JAX-bandflux/master/examples/plot_comparison.py
python<span class="w"> </span>plot_comparison.py
</pre></div>
</div>
<p><strong>What This Example Does:</strong></p>
<ol class="arabic simple">
<li><p>Loads supernova light curve data</p></li>
<li><p>Registers bandpasses</p></li>
<li><p>Computes model fluxes using different models (e.g., SALT3, SALT3-NIR)</p></li>
<li><p>Plots the observed and model light curves for comparison</p></li>
<li><p>Compares the best-fit parameters from different models</p></li>
</ol>
<p><strong>Key Differences Between Models:</strong></p>
<ul class="simple">
<li><p><strong>SALT3</strong>: Standard model with coverage from 2800Å to 12000Å</p></li>
<li><p><strong>SALT3-NIR</strong>: Extended model with coverage from 2800Å to 17000Å</p></li>
<li><p>The NIR extension is particularly important for high-redshift supernovae</p></li>
</ul>
</section>
<section id="custom-bandpasses">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Custom Bandpasses</a><a class="headerlink" href="#custom-bandpasses" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">download_svo_filter.py</span></code> example demonstrates how to download and use custom bandpasses from the Spanish Virtual Observatory (SVO) Filter Profile Service. This is useful for working with data from different instruments or creating synthetic filters.</p>
<p><strong>Running the Example:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download the WFCAM J filter profile</span>
python<span class="w"> </span>examples/download_svo_filter.py<span class="w"> </span>--filter<span class="w"> </span>UKIRT/WFCAM.J

<span class="c1"># List available common filters</span>
python<span class="w"> </span>examples/download_svo_filter.py<span class="w"> </span>--list

<span class="c1"># Run an example of using a custom bandpass in a SALT3 model fit</span>
python<span class="w"> </span>examples/download_svo_filter.py<span class="w"> </span>--example

<span class="c1"># Run with a different filter and bandpass name</span>
python<span class="w"> </span>examples/download_svo_filter.py<span class="w"> </span>--example<span class="w"> </span>--filter<span class="w"> </span>2MASS/2MASS.J<span class="w"> </span>--bandpass-name<span class="w"> </span>custom_2mass_J

<span class="c1"># Create a synthetic WFCAM J filter profile</span>
python<span class="w"> </span>examples/download_svo_filter.py<span class="w"> </span>--synthetic

<span class="c1"># Customize the number of points in the synthetic profile</span>
python<span class="w"> </span>examples/download_svo_filter.py<span class="w"> </span>--synthetic<span class="w"> </span>--points<span class="w"> </span><span class="m">200</span>
</pre></div>
</div>
<p><strong>What This Example Does:</strong></p>
<ol class="arabic simple">
<li><p>Downloads filter profiles from the SVO Filter Profile Service</p></li>
<li><p>Creates bandpass objects from the downloaded profiles</p></li>
<li><p>Registers the bandpasses for use in SALT3 model fitting</p></li>
<li><p>Demonstrates how to use custom bandpasses in a SALT3 model fit</p></li>
</ol>
<p><strong>Available SVO Filters:</strong></p>
<p>The SVO Filter Profile Service provides access to thousands of filter profiles from various instruments and surveys. Some commonly used filter sets include:</p>
<ul class="simple">
<li><p>SDSS (Sloan Digital Sky Survey)</p></li>
<li><p>HST (Hubble Space Telescope)</p></li>
<li><p>JWST (James Webb Space Telescope)</p></li>
<li><p>2MASS (Two Micron All Sky Survey)</p></li>
<li><p>UKIRT (United Kingdom Infrared Telescope)</p></li>
<li><p>ZTF (Zwicky Transient Facility)</p></li>
<li><p>LSST (Legacy Survey of Space and Time)</p></li>
</ul>
</section>
<section id="working-with-multiple-supernovae">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Working with Multiple Supernovae</a><a class="headerlink" href="#working-with-multiple-supernovae" title="Link to this heading"></a></h2>
<p>For population studies and cosmological analyses, you often need to work with multiple supernovae. JAX-bandflux makes this easy with its efficient data loading and processing functions.</p>
<p><strong>Example Use Cases:</strong></p>
<ul class="simple">
<li><p>Fitting multiple supernovae for cosmological analyses</p></li>
<li><p>Comparing properties across a population of supernovae</p></li>
<li><p>Creating Hubble diagrams</p></li>
<li><p>Studying correlations between supernova parameters</p></li>
</ul>
</section>
<section id="jax-optimization-techniques">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">JAX Optimization Techniques</a><a class="headerlink" href="#jax-optimization-techniques" title="Link to this heading"></a></h2>
<p>JAX provides several optimization techniques that can significantly improve performance:</p>
<ol class="arabic simple">
<li><p><strong>JIT Compilation</strong>: Using <cite>&#64;jax.jit</cite> to compile functions for faster execution</p></li>
<li><p><strong>Vectorization</strong>: Using <cite>jax.vmap</cite> to efficiently process multiple inputs</p></li>
<li><p><strong>GPU Acceleration</strong>: Automatically running computations on GPU when available</p></li>
<li><p><strong>Precomputed Data</strong>: Using precomputed bridge data for efficient flux calculations</p></li>
</ol>
<p>These techniques can provide speedups of 10-100x compared to standard implementations, especially for large datasets or complex models.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="api/constants.html" class="btn btn-neutral float-left" title="Constants Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="readthedocs_deployment_guide.html" class="btn btn-neutral float-right" title="Comprehensive Guide to Deploying JAX-bandflux Documentation on ReadTheDocs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Samuel Alan Kossoff Leeney.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 
<script>
  // Add any custom JavaScript here
</script>


</body>
</html>