

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bandpasses Module &mdash; JAX-bandflux 0.1.91 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=3741d27b" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8e1ed48b"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data Module" href="data.html" />
    <link rel="prev" title="SALT3 Module" href="salt3.html" />
 
<style>
  /* Custom styles */
  .wy-nav-content {
    max-width: 1000px !important;
  }
  
  /* Improve code block styling */
  div.highlight {
    background-color: #f8f8f8;
  }
  
  /* Improve table styling */
  table.docutils {
    width: 100%;
    margin-bottom: 1em;
  }
  
  table.docutils td, table.docutils th {
    padding: 8px;
  }
  
  /* Improve heading styling */
  h1, h2, h3, h4, h5, h6 {
    margin-top: 1.5em;
    margin-bottom: 0.5em;
  }
  
  /* Improve link styling */
  a.reference {
    border-bottom: 1px dotted #3091d1;
  }
  
  a.reference:hover {
    border-bottom: 1px solid #3091d1;
  }
</style>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            JAX-bandflux
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_concepts.html">Core Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#module-relationships">Module Relationships</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#using-the-api">Using the API</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="salt3.html">SALT3 Module</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Bandpasses Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.bandpasses.Bandpass"><code class="docutils literal notranslate"><span class="pre">Bandpass</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.bandpasses.get_bandpass_filepath"><code class="docutils literal notranslate"><span class="pre">get_bandpass_filepath()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.bandpasses.load_bandpass"><code class="docutils literal notranslate"><span class="pre">load_bandpass()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.bandpasses.load_bandpass_from_file"><code class="docutils literal notranslate"><span class="pre">load_bandpass_from_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.bandpasses.create_bandpass_from_svo"><code class="docutils literal notranslate"><span class="pre">create_bandpass_from_svo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.bandpasses.register_bandpass"><code class="docutils literal notranslate"><span class="pre">register_bandpass()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.bandpasses.get_bandpass"><code class="docutils literal notranslate"><span class="pre">get_bandpass()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.bandpasses.load_custom_bandpasses"><code class="docutils literal notranslate"><span class="pre">load_custom_bandpasses()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.bandpasses.register_all_bandpasses"><code class="docutils literal notranslate"><span class="pre">register_all_bandpasses()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bandpass-class">Bandpass Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bandpass-registry">Bandpass Registry</a></li>
<li class="toctree-l4"><a class="reference internal" href="#key-classes-and-functions">Key Classes and Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-usage">Example Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#loading-bandpasses-from-files">Loading Bandpasses from Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#svo-filter-profile-service-integration">SVO Filter Profile Service Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#supported-bandpasses">Supported Bandpasses</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-custom-bandpasses">Creating Custom Bandpasses</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data.html">Data Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html">Utils Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="constants.html">Constants Module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readthedocs_deployment_guide.html">Comprehensive Guide to Deploying JAX-bandflux Documentation on ReadTheDocs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readthedocs_visual_guide.html">ReadTheDocs Visual Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readthedocs_troubleshooting.html">ReadTheDocs Troubleshooting Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">JAX-bandflux</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">API Reference</a></li>
      <li class="breadcrumb-item active">Bandpasses Module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/bandpasses.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-jax_supernovae.bandpasses">
<span id="bandpasses-module"></span><h1>Bandpasses Module<a class="headerlink" href="#module-jax_supernovae.bandpasses" title="Link to this heading"></a></h1>
<p>Bandpass handling for JAX supernova models.</p>
<dl class="py class">
<dt class="sig sig-object py" id="jax_supernovae.bandpasses.Bandpass">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">jax_supernovae.bandpasses.</span></span><span class="sig-name descname"><span class="pre">Bandpass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integration_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/bandpasses.html#Bandpass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.bandpasses.Bandpass" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Bandpass filter class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="jax_supernovae.bandpasses.Bandpass.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/bandpasses.html#Bandpass.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.bandpasses.Bandpass.__call__" title="Link to this definition"></a></dt>
<dd><p>Get interpolated transmission at given wavelengths.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_supernovae.bandpasses.Bandpass.minwave">
<span class="sig-name descname"><span class="pre">minwave</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/bandpasses.html#Bandpass.minwave"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.bandpasses.Bandpass.minwave" title="Link to this definition"></a></dt>
<dd><p>Get minimum wavelength.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jax_supernovae.bandpasses.Bandpass.maxwave">
<span class="sig-name descname"><span class="pre">maxwave</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/bandpasses.html#Bandpass.maxwave"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.bandpasses.Bandpass.maxwave" title="Link to this definition"></a></dt>
<dd><p>Get maximum wavelength.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_supernovae.bandpasses.Bandpass.wave">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wave</span></span><a class="headerlink" href="#jax_supernovae.bandpasses.Bandpass.wave" title="Link to this definition"></a></dt>
<dd><p>Get wavelength array.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_supernovae.bandpasses.Bandpass.trans">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">trans</span></span><a class="headerlink" href="#jax_supernovae.bandpasses.Bandpass.trans" title="Link to this definition"></a></dt>
<dd><p>Get transmission array.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_supernovae.bandpasses.Bandpass.integration_wave">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">integration_wave</span></span><a class="headerlink" href="#jax_supernovae.bandpasses.Bandpass.integration_wave" title="Link to this definition"></a></dt>
<dd><p>Get pre-computed integration wavelength grid.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jax_supernovae.bandpasses.Bandpass.integration_spacing">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">integration_spacing</span></span><a class="headerlink" href="#jax_supernovae.bandpasses.Bandpass.integration_spacing" title="Link to this definition"></a></dt>
<dd><p>Get integration grid spacing.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.bandpasses.get_bandpass_filepath">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.bandpasses.</span></span><span class="sig-name descname"><span class="pre">get_bandpass_filepath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/bandpasses.html#get_bandpass_filepath"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.bandpasses.get_bandpass_filepath" title="Link to this definition"></a></dt>
<dd><p>Map bandpass name to file path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>band</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Bandpass name (e.g., ‘c’, ‘o’, ‘ztfg’, ‘g’, etc.)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to the bandpass file</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.bandpasses.load_bandpass">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.bandpasses.</span></span><span class="sig-name descname"><span class="pre">load_bandpass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">band</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/bandpasses.html#load_bandpass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.bandpasses.load_bandpass" title="Link to this definition"></a></dt>
<dd><p>Load a bandpass from file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>band</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the bandpass to load</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>bandpass</strong> – A Bandpass object containing the filter transmission curve.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jax_supernovae.bandpasses.Bandpass" title="jax_supernovae.bandpasses.Bandpass">Bandpass</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.bandpasses.load_bandpass_from_file">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.bandpasses.</span></span><span class="sig-name descname"><span class="pre">load_bandpass_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skiprows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/bandpasses.html#load_bandpass_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.bandpasses.load_bandpass_from_file" title="Link to this definition"></a></dt>
<dd><p>Load a bandpass from a custom file path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Path to the bandpass file</p></li>
<li><p><strong>skiprows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of header rows to skip</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Name to register the bandpass under. If None, uses the filename.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(name, bandpass) where:
- name is the registered name of the bandpass
- bandpass is the Bandpass object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.bandpasses.create_bandpass_from_svo">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.bandpasses.</span></span><span class="sig-name descname"><span class="pre">create_bandpass_from_svo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'filter_data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_download</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/bandpasses.html#create_bandpass_from_svo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.bandpasses.create_bandpass_from_svo" title="Link to this definition"></a></dt>
<dd><p>Create a bandpass object from a filter profile in the SVO Filter Profile Service.</p>
<p>This function downloads a filter profile from the Spanish Virtual Observatory (SVO)
Filter Profile Service and creates a Bandpass object from it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The SVO filter identifier, e.g., ‘UKIRT/WFCAM.J’</p></li>
<li><p><strong>output_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Directory to save the downloaded filter file. Default is ‘filter_data’.</p></li>
<li><p><strong>force_download</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, download the filter even if it already exists locally.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Bandpass object for the specified filter</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jax_supernovae.bandpasses.Bandpass" title="jax_supernovae.bandpasses.Bandpass">Bandpass</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.13)"><strong>FileNotFoundError</strong></a> – If the filter profile file cannot be found or downloaded</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.bandpasses.register_bandpass">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.bandpasses.</span></span><span class="sig-name descname"><span class="pre">register_bandpass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bandpass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/bandpasses.html#register_bandpass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.bandpasses.register_bandpass" title="Link to this definition"></a></dt>
<dd><p>Register a bandpass with a given name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name to register the bandpass under</p></li>
<li><p><strong>bandpass</strong> (<a class="reference internal" href="#jax_supernovae.bandpasses.Bandpass" title="jax_supernovae.bandpasses.Bandpass"><em>Bandpass</em></a>) – Bandpass object to register</p></li>
<li><p><strong>force</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, overwrite any existing bandpass with the same name</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If a bandpass with the given name already exists and force=False</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.bandpasses.get_bandpass">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.bandpasses.</span></span><span class="sig-name descname"><span class="pre">get_bandpass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/bandpasses.html#get_bandpass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.bandpasses.get_bandpass" title="Link to this definition"></a></dt>
<dd><p>Get a bandpass from the registry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference internal" href="#jax_supernovae.bandpasses.Bandpass" title="jax_supernovae.bandpasses.Bandpass"><em>Bandpass</em></a>) – Name of the bandpass or a Bandpass object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>bandpass</strong> – The requested bandpass</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jax_supernovae.bandpasses.Bandpass" title="jax_supernovae.bandpasses.Bandpass">Bandpass</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.bandpasses.load_custom_bandpasses">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.bandpasses.</span></span><span class="sig-name descname"><span class="pre">load_custom_bandpasses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bandpass_files</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/bandpasses.html#load_custom_bandpasses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.bandpasses.load_custom_bandpasses" title="Link to this definition"></a></dt>
<dd><p>Load custom bandpasses from a list of file paths.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bandpass_files</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – List of file paths to bandpass files, or a dictionary mapping
bandpass names to file paths</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping bandpass names to Bandpass objects</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.bandpasses.register_all_bandpasses">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.bandpasses.</span></span><span class="sig-name descname"><span class="pre">register_all_bandpasses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">custom_bandpass_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svo_filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/bandpasses.html#register_all_bandpasses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.bandpasses.register_all_bandpasses" title="Link to this definition"></a></dt>
<dd><p>Register bandpasses in JAX and return dictionaries of bandpasses and bridges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>custom_bandpass_files</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – List of file paths to custom bandpass files, or a dictionary mapping
bandpass names to file paths</p></li>
<li><p><strong>svo_filters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em>) – List of dictionaries containing SVO filter information. Each dictionary
should have the following keys:
- ‘name’: Name to register the bandpass under
- ‘filter_id’: SVO filter identifier (e.g., ‘UKIRT/WFCAM.J’)
- ‘variants’: Optional list of variant names to register using the same bandpass</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing:
- bandpass_dict: Dictionary mapping bandpass names to Bandpass objects
- bridges_dict: Dictionary mapping bandpass names to precomputed bridge data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">bandpasses</span></code> module provides functionality for managing astronomical filter bandpasses. It includes classes and functions for creating, registering, and manipulating bandpasses. Bandpasses represent the transmission functions of astronomical filters, which define how much light at each wavelength passes through the filter.</p>
<p>The module implements bandpass integration for calculating observed fluxes:</p>
<div class="math notranslate nohighlight">
\[\text{bandflux} = \int_{\lambda_\text{min}}^{\lambda_\text{max}} F(\lambda) \cdot T(\lambda) \cdot \frac{\lambda}{hc} \, d\lambda\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(F(\lambda)\)</span> is the model flux as a function of wavelength</p></li>
<li><p><span class="math notranslate nohighlight">\(T(\lambda)\)</span> is the transmission function of the bandpass filter</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda\)</span> is the wavelength</p></li>
<li><p><span class="math notranslate nohighlight">\(h\)</span> is the Planck constant</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> is the speed of light</p></li>
</ul>
<p>The factor <span class="math notranslate nohighlight">\(\frac{\lambda}{hc}\)</span> converts from energy flux to photon flux, which is what most astronomical detectors measure.</p>
</section>
<section id="bandpass-class">
<h2>Bandpass Class<a class="headerlink" href="#bandpass-class" title="Link to this heading"></a></h2>
<p>The core of the module is the <code class="docutils literal notranslate"><span class="pre">Bandpass</span></code> class, which represents a filter transmission curve. It stores wavelength and transmission arrays, and provides methods for interpolation, integration, and other operations.</p>
<p>Key features of the <code class="docutils literal notranslate"><span class="pre">Bandpass</span></code> class:</p>
<ul class="simple">
<li><p>Efficient interpolation using JAX</p></li>
<li><p>Methods for finding wavelength range (minwave, maxwave)</p></li>
<li><p>Callable interface for evaluating transmission at any wavelength</p></li>
<li><p>Integration with the SALT3 model for flux calculations</p></li>
</ul>
</section>
<section id="bandpass-registry">
<h2>Bandpass Registry<a class="headerlink" href="#bandpass-registry" title="Link to this heading"></a></h2>
<p>The module maintains a global registry of bandpasses, which allows them to be accessed by name. This is particularly useful for working with multiple bandpasses and for integrating with the SALT3 model.</p>
<p>Key functions for managing the registry:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">register_bandpass</span></code>: Register a bandpass with a given name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_bandpass</span></code>: Get a registered bandpass by name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">register_all_bandpasses</span></code>: Register all built-in bandpasses</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_all_bandpasses</span></code>: Get all registered bandpasses</p></li>
</ul>
</section>
<section id="key-classes-and-functions">
<h2>Key Classes and Functions<a class="headerlink" href="#key-classes-and-functions" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#jax_supernovae.bandpasses.Bandpass" title="jax_supernovae.bandpasses.Bandpass"><code class="xref py py-obj docutils literal notranslate"><span class="pre">jax_supernovae.bandpasses.Bandpass</span></code></a></p></td>
<td><p>Bandpass filter class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#jax_supernovae.bandpasses.register_bandpass" title="jax_supernovae.bandpasses.register_bandpass"><code class="xref py py-obj docutils literal notranslate"><span class="pre">jax_supernovae.bandpasses.register_bandpass</span></code></a></p></td>
<td><p>Register a bandpass with a given name.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#jax_supernovae.bandpasses.get_bandpass" title="jax_supernovae.bandpasses.get_bandpass"><code class="xref py py-obj docutils literal notranslate"><span class="pre">jax_supernovae.bandpasses.get_bandpass</span></code></a></p></td>
<td><p>Get a bandpass from the registry.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#jax_supernovae.bandpasses.register_all_bandpasses" title="jax_supernovae.bandpasses.register_all_bandpasses"><code class="xref py py-obj docutils literal notranslate"><span class="pre">jax_supernovae.bandpasses.register_all_bandpasses</span></code></a></p></td>
<td><p>Register bandpasses in JAX and return dictionaries of bandpasses and bridges.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#jax_supernovae.bandpasses.load_bandpass_from_file" title="jax_supernovae.bandpasses.load_bandpass_from_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">jax_supernovae.bandpasses.load_bandpass_from_file</span></code></a></p></td>
<td><p>Load a bandpass from a custom file path.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#jax_supernovae.bandpasses.load_bandpass_from_file" title="jax_supernovae.bandpasses.load_bandpass_from_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">jax_supernovae.bandpasses.load_bandpass_from_file</span></code></a></p></td>
<td><p>Load a bandpass from a custom file path.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="example-usage">
<h2>Example Usage<a class="headerlink" href="#example-usage" title="Link to this heading"></a></h2>
<p>Creating and Registering Bandpasses:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jax_supernovae.bandpasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">Bandpass</span><span class="p">,</span> <span class="n">register_bandpass</span><span class="p">,</span> <span class="n">get_bandpass</span><span class="p">,</span> <span class="n">register_all_bandpasses</span>

<span class="c1"># Enable float64 precision for better accuracy</span>
<span class="n">jax</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;jax_enable_x64&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create a rectangular bandpass</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">4000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">trans</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">wave</span><span class="p">)</span>
<span class="n">rect_bandpass</span> <span class="o">=</span> <span class="n">Bandpass</span><span class="p">(</span><span class="n">wave</span><span class="o">=</span><span class="n">wave</span><span class="p">,</span> <span class="n">trans</span><span class="o">=</span><span class="n">trans</span><span class="p">)</span>

<span class="c1"># Create a Gaussian bandpass</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">4000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">trans</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">((</span><span class="n">wave</span> <span class="o">-</span> <span class="mi">4500</span><span class="p">)</span> <span class="o">/</span> <span class="mi">200</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">gauss_bandpass</span> <span class="o">=</span> <span class="n">Bandpass</span><span class="p">(</span><span class="n">wave</span><span class="o">=</span><span class="n">wave</span><span class="p">,</span> <span class="n">trans</span><span class="o">=</span><span class="n">trans</span><span class="p">)</span>

<span class="c1"># Register the bandpasses</span>
<span class="n">register_bandpass</span><span class="p">(</span><span class="s1">&#39;rectangular&#39;</span><span class="p">,</span> <span class="n">rect_bandpass</span><span class="p">)</span>
<span class="n">register_bandpass</span><span class="p">(</span><span class="s1">&#39;gaussian&#39;</span><span class="p">,</span> <span class="n">gauss_bandpass</span><span class="p">)</span>

<span class="c1"># Register all built-in bandpasses</span>
<span class="n">bandpass_dict</span><span class="p">,</span> <span class="n">bridges_dict</span> <span class="o">=</span> <span class="n">register_all_bandpasses</span><span class="p">()</span>

<span class="c1"># Access registered bandpasses</span>
<span class="n">rect_bp</span> <span class="o">=</span> <span class="n">get_bandpass</span><span class="p">(</span><span class="s1">&#39;rectangular&#39;</span><span class="p">)</span>
<span class="n">gauss_bp</span> <span class="o">=</span> <span class="n">get_bandpass</span><span class="p">(</span><span class="s1">&#39;gaussian&#39;</span><span class="p">)</span>
<span class="n">ztfg_bp</span> <span class="o">=</span> <span class="n">get_bandpass</span><span class="p">(</span><span class="s1">&#39;ztfg&#39;</span><span class="p">)</span>

<span class="c1"># Print wavelength ranges</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rectangular bandpass: </span><span class="si">{</span><span class="n">rect_bp</span><span class="o">.</span><span class="n">minwave</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">rect_bp</span><span class="o">.</span><span class="n">maxwave</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gaussian bandpass: </span><span class="si">{</span><span class="n">gauss_bp</span><span class="o">.</span><span class="n">minwave</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">gauss_bp</span><span class="o">.</span><span class="n">maxwave</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ZTF g bandpass: </span><span class="si">{</span><span class="n">ztfg_bp</span><span class="o">.</span><span class="n">minwave</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">ztfg_bp</span><span class="o">.</span><span class="n">maxwave</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Visualizing Bandpasses:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Plot the bandpasses</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Plot rectangular bandpass</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rect_bp</span><span class="o">.</span><span class="n">wave</span><span class="p">,</span> <span class="n">rect_bp</span><span class="o">.</span><span class="n">trans</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Rectangular&#39;</span><span class="p">)</span>

<span class="c1"># Plot Gaussian bandpass</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gauss_bp</span><span class="o">.</span><span class="n">wave</span><span class="p">,</span> <span class="n">gauss_bp</span><span class="o">.</span><span class="n">trans</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gaussian&#39;</span><span class="p">)</span>

<span class="c1"># Plot ZTF g bandpass</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ztfg_bp</span><span class="o">.</span><span class="n">wave</span><span class="p">,</span> <span class="n">ztfg_bp</span><span class="o">.</span><span class="n">trans</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ZTF g&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (Å)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Transmission&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Bandpass Comparison&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="loading-bandpasses-from-files">
<h2>Loading Bandpasses from Files<a class="headerlink" href="#loading-bandpasses-from-files" title="Link to this heading"></a></h2>
<p>JAX-bandflux supports loading bandpasses from files in various formats:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jax_supernovae.bandpasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_bandpass_from_file</span><span class="p">,</span> <span class="n">register_bandpass</span>

<span class="c1"># Enable float64 precision</span>
<span class="n">jax</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;jax_enable_x64&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Load a bandpass from a file</span>
<span class="n">name</span><span class="p">,</span> <span class="n">bandpass</span> <span class="o">=</span> <span class="n">load_bandpass_from_file</span><span class="p">(</span><span class="s1">&#39;path/to/bandpass.dat&#39;</span><span class="p">)</span>

<span class="c1"># Register the bandpass</span>
<span class="n">register_bandpass</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">bandpass</span><span class="p">)</span>

<span class="c1"># Print information about the bandpass</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded bandpass &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; with wavelength range: </span><span class="si">{</span><span class="n">bandpass</span><span class="o">.</span><span class="n">minwave</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">bandpass</span><span class="o">.</span><span class="n">maxwave</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of points: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">bandpass</span><span class="o">.</span><span class="n">wave</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The file format should be a simple text file with two columns: wavelength (in Angstroms) and transmission. For example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Wavelength (Å)  Transmission
4000.0            0.0
4100.0            0.2
4200.0            0.5
4300.0            0.8
4400.0            1.0
4500.0            1.0
4600.0            0.8
4700.0            0.5
4800.0            0.2
4900.0            0.0
5000.0            0.0
</pre></div>
</div>
</section>
<section id="svo-filter-profile-service-integration">
<h2>SVO Filter Profile Service Integration<a class="headerlink" href="#svo-filter-profile-service-integration" title="Link to this heading"></a></h2>
<p>JAX-bandflux provides integration with the Spanish Virtual Observatory (SVO) Filter Profile Service, which offers a comprehensive database of filter profiles from various instruments and surveys:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jax_supernovae.bandpasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">download_svo_filter</span><span class="p">,</span> <span class="n">register_bandpass</span>

<span class="c1"># Enable float64 precision</span>
<span class="n">jax</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;jax_enable_x64&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Download a filter from SVO</span>
<span class="n">filter_id</span> <span class="o">=</span> <span class="s1">&#39;SLOAN/SDSS.g&#39;</span>
<span class="n">filepath</span> <span class="o">=</span> <span class="n">download_svo_filter</span><span class="p">(</span><span class="n">filter_id</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;filter_data&#39;</span><span class="p">)</span>

<span class="c1"># Load the filter and register it</span>
<span class="n">name</span><span class="p">,</span> <span class="n">bandpass</span> <span class="o">=</span> <span class="n">load_bandpass_from_file</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<span class="n">register_bandpass</span><span class="p">(</span><span class="s1">&#39;sdss_g&#39;</span><span class="p">,</span> <span class="n">bandpass</span><span class="p">)</span>

<span class="c1"># Print information about the bandpass</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloaded and registered SDSS g-band filter&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wavelength range: </span><span class="si">{</span><span class="n">bandpass</span><span class="o">.</span><span class="n">minwave</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">bandpass</span><span class="o">.</span><span class="n">maxwave</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> Å&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of points: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">bandpass</span><span class="o">.</span><span class="n">wave</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="supported-bandpasses">
<h2>Supported Bandpasses<a class="headerlink" href="#supported-bandpasses" title="Link to this heading"></a></h2>
<p>JAX-bandflux includes built-in support for many common astronomical filters. These can be registered using the <code class="docutils literal notranslate"><span class="pre">register_all_bandpasses()</span></code> function:</p>
<ul class="simple">
<li><p><strong>ZTF bandpasses</strong>:
- <code class="docutils literal notranslate"><span class="pre">ztfg</span></code>: ZTF g-band (4087-5522 Å)
- <code class="docutils literal notranslate"><span class="pre">ztfr</span></code>: ZTF r-band (5600-7316 Å)</p></li>
<li><p><strong>ATLAS bandpasses</strong>:
- <code class="docutils literal notranslate"><span class="pre">c</span></code>: ATLAS cyan filter (4200-6500 Å)
- <code class="docutils literal notranslate"><span class="pre">o</span></code>: ATLAS orange filter (5600-8200 Å)</p></li>
<li><p><strong>SDSS bandpasses</strong>:
- <code class="docutils literal notranslate"><span class="pre">g</span></code>: SDSS g-band (3800-5500 Å)
- <code class="docutils literal notranslate"><span class="pre">r</span></code>: SDSS r-band (5500-7000 Å)
- <code class="docutils literal notranslate"><span class="pre">i</span></code>: SDSS i-band (7000-8500 Å)
- <code class="docutils literal notranslate"><span class="pre">z</span></code>: SDSS z-band (8500-10000 Å)</p></li>
<li><p><strong>2MASS bandpasses</strong>:
- <code class="docutils literal notranslate"><span class="pre">H</span></code>: 2MASS H-band (1.5-1.8 μm)</p></li>
<li><p><strong>WFCAM bandpasses</strong>:
- <code class="docutils literal notranslate"><span class="pre">J</span></code>: WFCAM J-band (1.17-1.33 μm)
- <code class="docutils literal notranslate"><span class="pre">J_1D3</span></code>: WFCAM J-band (1D3 version)</p></li>
</ul>
<p>Additionally, you can access thousands of other filters through the SVO Filter Profile Service integration.</p>
</section>
<section id="creating-custom-bandpasses">
<h2>Creating Custom Bandpasses<a class="headerlink" href="#creating-custom-bandpasses" title="Link to this heading"></a></h2>
<p>You can create custom bandpasses with specific shapes or properties:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jax_supernovae.bandpasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">Bandpass</span><span class="p">,</span> <span class="n">register_bandpass</span>

<span class="c1"># Enable float64 precision</span>
<span class="n">jax</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;jax_enable_x64&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create a custom bandpass with atmospheric effects</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_realistic_filter</span><span class="p">(</span><span class="n">central_wave</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">,</span> <span class="n">num_points</span><span class="o">=</span><span class="mi">200</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a realistic filter with atmospheric effects.&quot;&quot;&quot;</span>
    <span class="c1"># Create wavelength grid</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">fwhm</span> <span class="o">/</span> <span class="mf">2.355</span>
    <span class="n">wave</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">central_wave</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">central_wave</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">num_points</span><span class="p">)</span>

    <span class="c1"># Create base Gaussian transmission</span>
    <span class="n">trans</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">((</span><span class="n">wave</span> <span class="o">-</span> <span class="n">central_wave</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Add atmospheric absorption (simplified)</span>
    <span class="k">if</span> <span class="n">central_wave</span> <span class="o">&gt;</span> <span class="mi">7500</span> <span class="ow">and</span> <span class="n">central_wave</span> <span class="o">&lt;</span> <span class="mi">7700</span><span class="p">:</span>
        <span class="c1"># O2 A-band absorption</span>
        <span class="n">o2_abs</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">((</span><span class="n">wave</span> <span class="o">-</span> <span class="mi">7600</span><span class="p">)</span> <span class="o">/</span> <span class="mi">15</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">trans</span> <span class="o">=</span> <span class="n">trans</span> <span class="o">*</span> <span class="n">o2_abs</span>

    <span class="k">return</span> <span class="n">Bandpass</span><span class="p">(</span><span class="n">wave</span><span class="o">=</span><span class="n">wave</span><span class="p">,</span> <span class="n">trans</span><span class="o">=</span><span class="n">trans</span><span class="p">)</span>

<span class="c1"># Create and register a custom filter</span>
<span class="n">custom_bp</span> <span class="o">=</span> <span class="n">create_realistic_filter</span><span class="p">(</span><span class="mi">6200</span><span class="p">,</span> <span class="mi">1200</span><span class="p">)</span>
<span class="n">register_bandpass</span><span class="p">(</span><span class="s1">&#39;custom_r&#39;</span><span class="p">,</span> <span class="n">custom_bp</span><span class="p">)</span>

<span class="c1"># Plot the custom bandpass</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">custom_bp</span><span class="o">.</span><span class="n">wave</span><span class="p">,</span> <span class="n">custom_bp</span><span class="o">.</span><span class="n">trans</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (Å)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Transmission&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Custom r-band Filter with Atmospheric Effects&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="salt3.html" class="btn btn-neutral float-left" title="SALT3 Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="data.html" class="btn btn-neutral float-right" title="Data Module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Samuel Alan Kossoff Leeney.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 
<script>
  // Add any custom JavaScript here
</script>


</body>
</html>