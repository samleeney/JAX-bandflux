

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SALT3 Module &mdash; JAX-bandflux 0.1.91 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=3741d27b" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8e1ed48b"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Bandpasses Module" href="bandpasses.html" />
    <link rel="prev" title="API Reference" href="index.html" />
 
<style>
  /* Custom styles */
  .wy-nav-content {
    max-width: 1000px !important;
  }
  
  /* Improve code block styling */
  div.highlight {
    background-color: #f8f8f8;
  }
  
  /* Improve table styling */
  table.docutils {
    width: 100%;
    margin-bottom: 1em;
  }
  
  table.docutils td, table.docutils th {
    padding: 8px;
  }
  
  /* Improve heading styling */
  h1, h2, h3, h4, h5, h6 {
    margin-top: 1.5em;
    margin-bottom: 0.5em;
  }
  
  /* Improve link styling */
  a.reference {
    border-bottom: 1px dotted #3091d1;
  }
  
  a.reference:hover {
    border-bottom: 1px solid #3091d1;
  }
</style>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            JAX-bandflux
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_concepts.html">Core Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#module-relationships">Module Relationships</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#using-the-api">Using the API</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">SALT3 Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.salt3.read_griddata_file"><code class="docutils literal notranslate"><span class="pre">read_griddata_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.salt3.kernval"><code class="docutils literal notranslate"><span class="pre">kernval()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.salt3.find_index"><code class="docutils literal notranslate"><span class="pre">find_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.salt3.compute_interpolation_weights"><code class="docutils literal notranslate"><span class="pre">compute_interpolation_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.salt3.interpolate_2d"><code class="docutils literal notranslate"><span class="pre">interpolate_2d()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.salt3.salt3_m0_single"><code class="docutils literal notranslate"><span class="pre">salt3_m0_single()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.salt3.salt3_m1_single"><code class="docutils literal notranslate"><span class="pre">salt3_m1_single()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.salt3.salt3_m0"><code class="docutils literal notranslate"><span class="pre">salt3_m0()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.salt3.salt3_m1"><code class="docutils literal notranslate"><span class="pre">salt3_m1()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.salt3.salt3_colorlaw"><code class="docutils literal notranslate"><span class="pre">salt3_colorlaw()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.salt3.salt3_bandflux"><code class="docutils literal notranslate"><span class="pre">salt3_bandflux()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.salt3.salt3_multiband_flux"><code class="docutils literal notranslate"><span class="pre">salt3_multiband_flux()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.salt3.precompute_bandflux_bridge"><code class="docutils literal notranslate"><span class="pre">precompute_bandflux_bridge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.salt3.optimized_salt3_bandflux"><code class="docutils literal notranslate"><span class="pre">optimized_salt3_bandflux()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#jax_supernovae.salt3.optimized_salt3_multiband_flux"><code class="docutils literal notranslate"><span class="pre">optimized_salt3_multiband_flux()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model-components">Model Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="#key-functions">Key Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-usage">Example Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="bandpasses.html">Bandpasses Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html">Data Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html">Utils Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="constants.html">Constants Module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readthedocs_deployment_guide.html">Comprehensive Guide to Deploying JAX-bandflux Documentation on ReadTheDocs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readthedocs_visual_guide.html">ReadTheDocs Visual Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readthedocs_troubleshooting.html">ReadTheDocs Troubleshooting Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">JAX-bandflux</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">API Reference</a></li>
      <li class="breadcrumb-item active">SALT3 Module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/salt3.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="salt3-module">
<h1>SALT3 Module<a class="headerlink" href="#salt3-module" title="Link to this heading"></a></h1>
<p id="module-jax_supernovae.salt3">SALT3-NIR model implementation in JAX.</p>
<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.salt3.read_griddata_file">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.salt3.</span></span><span class="sig-name descname"><span class="pre">read_griddata_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/salt3.html#read_griddata_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.salt3.read_griddata_file" title="Link to this definition"></a></dt>
<dd><p>Read 2-d grid data from a text file.</p>
<p>Each line has values <cite>x0 x1 y</cite> (phase, wavelength, flux). Space separated.
Returns phase, wavelength arrays and a 2D grid of values.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.salt3.kernval">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.salt3.</span></span><span class="sig-name descname"><span class="pre">kernval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/salt3.html#kernval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.salt3.kernval" title="Link to this definition"></a></dt>
<dd><p>Compute kernel value for bicubic interpolation.</p>
<p>This matches SNCosmo’s implementation exactly:
W(x) = (a+2)*x**3-(a+3)*x**2+1 for x&lt;=1
W(x) = a( x**3-5*x**2+8*x-4) for 1&lt;x&lt;2
W(x) = 0 for x&gt;2
where a=-0.5</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.salt3.find_index">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.salt3.</span></span><span class="sig-name descname"><span class="pre">find_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/salt3.html#find_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.salt3.find_index" title="Link to this definition"></a></dt>
<dd><p>Find index i such that values[i] &lt;= x &lt; values[i+1].</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.salt3.compute_interpolation_weights">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.salt3.</span></span><span class="sig-name descname"><span class="pre">compute_interpolation_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/salt3.html#compute_interpolation_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.salt3.compute_interpolation_weights" title="Link to this definition"></a></dt>
<dd><p>Compute interpolation weights and indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – The point to interpolate at</p></li>
<li><p><strong>values</strong> – The grid values to interpolate between</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(indices, normalized coordinates, near_boundary)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.salt3.interpolate_2d">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.salt3.</span></span><span class="sig-name descname"><span class="pre">interpolate_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/salt3.html#interpolate_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.salt3.interpolate_2d" title="Link to this definition"></a></dt>
<dd><p>Perform 2D interpolation on gridded data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> – Phase value to interpolate at</p></li>
<li><p><strong>wave</strong> – Wavelength value to interpolate at</p></li>
<li><p><strong>data</strong> – 2D grid of values to interpolate from</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Interpolated value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.salt3.salt3_m0_single">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.salt3.</span></span><span class="sig-name descname"><span class="pre">salt3_m0_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/salt3.html#salt3_m0_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.salt3.salt3_m0_single" title="Link to this definition"></a></dt>
<dd><p>Get the M0 component at a single phase and wavelength.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.salt3.salt3_m1_single">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.salt3.</span></span><span class="sig-name descname"><span class="pre">salt3_m1_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/salt3.html#salt3_m1_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.salt3.salt3_m1_single" title="Link to this definition"></a></dt>
<dd><p>Get the M1 component at a single phase and wavelength.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.salt3.salt3_m0">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.salt3.</span></span><span class="sig-name descname"><span class="pre">salt3_m0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/salt3.html#salt3_m0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.salt3.salt3_m0" title="Link to this definition"></a></dt>
<dd><p>Get the M0 component at the given phase and wavelength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>array</em>) – Rest-frame phase in days</p></li>
<li><p><strong>wave</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>array</em>) – Rest-frame wavelength in Angstroms</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>M0 component value(s)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a> or array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.salt3.salt3_m1">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.salt3.</span></span><span class="sig-name descname"><span class="pre">salt3_m1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/salt3.html#salt3_m1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.salt3.salt3_m1" title="Link to this definition"></a></dt>
<dd><p>Get the M1 component at the given phase and wavelength.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>array</em>) – Rest-frame phase in days</p></li>
<li><p><strong>wave</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>array</em>) – Rest-frame wavelength in Angstroms</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>M1 component value(s)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a> or array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.salt3.salt3_colorlaw">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.salt3.</span></span><span class="sig-name descname"><span class="pre">salt3_colorlaw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/salt3.html#salt3_colorlaw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.salt3.salt3_colorlaw" title="Link to this definition"></a></dt>
<dd><p>Calculate SALT3 color law at given wavelength.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.salt3.salt3_bandflux">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.salt3.</span></span><span class="sig-name descname"><span class="pre">salt3_bandflux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bandpass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zpsys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/salt3.html#salt3_bandflux"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.salt3.salt3_bandflux" title="Link to this definition"></a></dt>
<dd><p>Calculate bandflux for SALT3 model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>brightness.</strong> (<em>Rest-frame phase in days relative to maximum</em>)</p>
</dd>
</dl>
<dl class="simple">
<dt>bandpass<span class="classifier">Bandpass object</span></dt><dd><p>Bandpass to calculate flux through.</p>
</dd>
<dt>params<span class="classifier">dict</span></dt><dd><p>Model parameters including z, t0, x0, x1, c.</p>
</dd>
<dt>zp<span class="classifier">float or None, optional</span></dt><dd><p>Zero point for flux. If None, no scaling is applied.</p>
</dd>
<dt>zpsys<span class="classifier">str, optional</span></dt><dd><p>Magnitude system for zero point. Must be provided if zp is not None.
Default is None.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Flux in photons/s/cm^2. Return value is float if phase is scalar,
array if phase is array. If zp and zpsys are given, flux is scaled
to the requested zeropoint.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a> or array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.salt3.salt3_multiband_flux">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.salt3.</span></span><span class="sig-name descname"><span class="pre">salt3_multiband_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bandpasses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zpsys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/salt3.html#salt3_multiband_flux"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.salt3.salt3_multiband_flux" title="Link to this definition"></a></dt>
<dd><p>Calculate flux for multiple bandpasses at once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>array-like</em>) – Phase(s) in observer frame.</p></li>
<li><p><strong>bandpasses</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of Bandpass objects.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – Model parameters including z, t0, x0, x1, c.</p></li>
<li><p><strong>zps</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Zero points for each bandpass.</p></li>
<li><p><strong>zpsys</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Magnitude system (e.g. ‘ab’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Flux values for each phase and bandpass combination.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.salt3.precompute_bandflux_bridge">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.salt3.</span></span><span class="sig-name descname"><span class="pre">precompute_bandflux_bridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bandpass</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/salt3.html#precompute_bandflux_bridge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.salt3.precompute_bandflux_bridge" title="Link to this definition"></a></dt>
<dd><p>Precompute static components for a given bandpass.</p>
<dl class="simple">
<dt>Returns a dictionary containing:</dt><dd><ul class="simple">
<li><p>‘wave’: the integration wavelength grid,</p></li>
<li><p>‘dwave’: spacing between grid points,</p></li>
<li><p>‘trans’: the transmission values computed on the grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.salt3.optimized_salt3_bandflux">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.salt3.</span></span><span class="sig-name descname"><span class="pre">optimized_salt3_bandflux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dwave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zpsys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/salt3.html#optimized_salt3_bandflux"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.salt3.optimized_salt3_bandflux" title="Link to this definition"></a></dt>
<dd><p>Calculate bandflux for a single bandpass using precomputed static data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> – array or scalar
Observer-frame phase(s) at which to compute the flux.</p></li>
<li><p><strong>wave</strong> – array
Wavelength grid for integration.</p></li>
<li><p><strong>dwave</strong> – float
Spacing between wavelength grid points.</p></li>
<li><p><strong>trans</strong> – array
Transmission values on the wavelength grid.</p></li>
<li><p><strong>params</strong> – dict
Dictionary containing model parameters: ‘z’, ‘t0’, ‘x0’, ‘x1’, ‘c’.</p></li>
<li><p><strong>zp</strong> – float or None
Zero point for flux scaling. If provided, zpsys must also be given.</p></li>
<li><p><strong>zpsys</strong> – str or None
Magnitude system (e.g. ‘ab’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Flux in photons/s/cm^2. If phase is scalar then returns scalar.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jax_supernovae.salt3.optimized_salt3_multiband_flux">
<span class="sig-prename descclassname"><span class="pre">jax_supernovae.salt3.</span></span><span class="sig-name descname"><span class="pre">optimized_salt3_multiband_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bridges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zpsys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/jax_supernovae/salt3.html#optimized_salt3_multiband_flux"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#jax_supernovae.salt3.optimized_salt3_multiband_flux" title="Link to this definition"></a></dt>
<dd><p>Calculate fluxes for multiple bandpasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> – array
Observer-frame phases.</p></li>
<li><p><strong>bridges</strong> – list of dict
Precomputed bridge data for each bandpass.</p></li>
<li><p><strong>params</strong> – dict
Model parameters.</p></li>
<li><p><strong>zps</strong> – list or array or None
Zero points for each bandpass.</p></li>
<li><p><strong>zpsys</strong> – str or None
Magnitude system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of flux values for each phase and band.</p>
</dd>
</dl>
</dd></dl>

<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">salt3</span></code> module implements the SALT3 model for Type Ia supernova light curves. It provides functions for computing model fluxes and bandfluxes in a differentiable way using JAX. The SALT3 model extends the SALT2 model with improved near-infrared coverage and updated training data.</p>
<p>The SALT3 model is defined as:</p>
<div class="math notranslate nohighlight">
\[F(p, \lambda) = x_0 \left[ M_0(p, \lambda) + x_1 M_1(p, \lambda) \right] \times 10^{-0.4 \times c \times CL(\lambda)}\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(F(p, \lambda)\)</span> is the spectral energy distribution (SED) at phase <span class="math notranslate nohighlight">\(p\)</span> and wavelength <span class="math notranslate nohighlight">\(\lambda\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x_0\)</span> is the amplitude parameter</p></li>
<li><p><span class="math notranslate nohighlight">\(x_1\)</span> is the stretch parameter</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span> is the color parameter</p></li>
<li><p><span class="math notranslate nohighlight">\(M_0(p, \lambda)\)</span> is the mean SED component</p></li>
<li><p><span class="math notranslate nohighlight">\(M_1(p, \lambda)\)</span> is the first-order variation component</p></li>
<li><p><span class="math notranslate nohighlight">\(CL(\lambda)\)</span> is the color law</p></li>
</ul>
<p>The module provides efficient implementations of these components, optimized for performance and differentiability.</p>
</section>
<section id="model-components">
<h2>Model Components<a class="headerlink" href="#model-components" title="Link to this heading"></a></h2>
<p>The SALT3 model consists of several key components:</p>
<ol class="arabic simple">
<li><p><strong>M0 Component</strong> (<cite>salt3_m0</cite>): The mean SED component, representing the average Type Ia supernova spectrum as a function of phase and wavelength.</p></li>
<li><p><strong>M1 Component</strong> (<cite>salt3_m1</cite>): The first-order variation component, which captures the primary spectral diversity of SNe Ia.</p></li>
<li><p><strong>Color Law</strong> (<cite>salt3_colorlaw</cite>): A function that describes how the color parameter affects the SED at different wavelengths.</p></li>
<li><p><strong>Flux Calculation</strong> (<cite>salt3_flux</cite>): Combines the components to calculate the model flux at a given phase and wavelength.</p></li>
<li><p><strong>Bandpass Integration</strong> (<cite>salt3_bandflux</cite>): Integrates the model flux over a bandpass to calculate the observed flux.</p></li>
</ol>
</section>
<section id="key-functions">
<h2>Key Functions<a class="headerlink" href="#key-functions" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#jax_supernovae.salt3.salt3_m0" title="jax_supernovae.salt3.salt3_m0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">jax_supernovae.salt3.salt3_m0</span></code></a></p></td>
<td><p>Get the M0 component at the given phase and wavelength.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#jax_supernovae.salt3.salt3_m1" title="jax_supernovae.salt3.salt3_m1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">jax_supernovae.salt3.salt3_m1</span></code></a></p></td>
<td><p>Get the M1 component at the given phase and wavelength.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#jax_supernovae.salt3.salt3_colorlaw" title="jax_supernovae.salt3.salt3_colorlaw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">jax_supernovae.salt3.salt3_colorlaw</span></code></a></p></td>
<td><p>Calculate SALT3 color law at given wavelength.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#jax_supernovae.salt3.salt3_bandflux" title="jax_supernovae.salt3.salt3_bandflux"><code class="xref py py-obj docutils literal notranslate"><span class="pre">jax_supernovae.salt3.salt3_bandflux</span></code></a></p></td>
<td><p>Calculate bandflux for SALT3 model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#jax_supernovae.salt3.precompute_bandflux_bridge" title="jax_supernovae.salt3.precompute_bandflux_bridge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">jax_supernovae.salt3.precompute_bandflux_bridge</span></code></a></p></td>
<td><p>Precompute static components for a given bandpass.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#jax_supernovae.salt3.optimized_salt3_bandflux" title="jax_supernovae.salt3.optimized_salt3_bandflux"><code class="xref py py-obj docutils literal notranslate"><span class="pre">jax_supernovae.salt3.optimized_salt3_bandflux</span></code></a></p></td>
<td><p>Calculate bandflux for a single bandpass using precomputed static data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#jax_supernovae.salt3.optimized_salt3_multiband_flux" title="jax_supernovae.salt3.optimized_salt3_multiband_flux"><code class="xref py py-obj docutils literal notranslate"><span class="pre">jax_supernovae.salt3.optimized_salt3_multiband_flux</span></code></a></p></td>
<td><p>Calculate fluxes for multiple bandpasses.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Link to this heading"></a></h2>
<p>The SALT3 model has the following parameters:</p>
<ul class="simple">
<li><p><strong>z</strong>: Redshift of the supernova</p></li>
<li><p><strong>t0</strong>: Time of peak brightness (MJD)</p></li>
<li><p><strong>x0</strong>: Amplitude parameter, related to the distance modulus</p></li>
<li><p><strong>x1</strong>: Stretch parameter, related to the light curve width</p></li>
<li><p><strong>c</strong>: Color parameter, related to the B-V color</p></li>
</ul>
<p>These parameters are typically passed as a dictionary:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>      <span class="c1"># Redshift</span>
    <span class="s1">&#39;t0&#39;</span><span class="p">:</span> <span class="mf">58650.0</span><span class="p">,</span> <span class="c1"># Time of peak brightness (MJD)</span>
    <span class="s1">&#39;x0&#39;</span><span class="p">:</span> <span class="mf">1e-5</span><span class="p">,</span>    <span class="c1"># Amplitude parameter</span>
    <span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>     <span class="c1"># Stretch parameter</span>
    <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">0.0</span>       <span class="c1"># Color parameter</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="performance-optimization">
<h2>Performance Optimization<a class="headerlink" href="#performance-optimization" title="Link to this heading"></a></h2>
<p>The module provides several optimized functions for efficient flux calculations:</p>
<ul class="simple">
<li><p><strong>precompute_bandflux_bridge</strong>: Precomputes data needed for efficient bandflux calculations</p></li>
<li><p><strong>optimized_salt3_bandflux</strong>: Optimized version of salt3_bandflux using precomputed data</p></li>
<li><p><strong>optimized_salt3_multiband_flux</strong>: Calculates fluxes for multiple bands and phases efficiently</p></li>
</ul>
<p>These optimized functions can provide significant speedups, especially for large datasets or when fitting many supernovae.</p>
</section>
<section id="example-usage">
<h2>Example Usage<a class="headerlink" href="#example-usage" title="Link to this heading"></a></h2>
<p>Basic Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jax_supernovae.salt3</span><span class="w"> </span><span class="kn">import</span> <span class="n">salt3_bandflux</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jax_supernovae.bandpasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">register_bandpass</span><span class="p">,</span> <span class="n">Bandpass</span>

<span class="c1"># Enable float64 precision for better accuracy</span>
<span class="n">jax</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;jax_enable_x64&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create a bandpass</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">4000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">trans</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">wave</span><span class="p">)</span>
<span class="n">bandpass</span> <span class="o">=</span> <span class="n">Bandpass</span><span class="p">(</span><span class="n">wave</span><span class="o">=</span><span class="n">wave</span><span class="p">,</span> <span class="n">trans</span><span class="o">=</span><span class="n">trans</span><span class="p">)</span>

<span class="c1"># Register the bandpass</span>
<span class="n">register_bandpass</span><span class="p">(</span><span class="s1">&#39;my_bandpass&#39;</span><span class="p">,</span> <span class="n">bandpass</span><span class="p">)</span>

<span class="c1"># Define SALT3 parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;t0&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s1">&#39;x0&#39;</span><span class="p">:</span> <span class="mf">1e-5</span><span class="p">,</span>
    <span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="p">}</span>

<span class="c1"># Compute bandflux</span>
<span class="n">time</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">flux</span> <span class="o">=</span> <span class="n">salt3_bandflux</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">bandpass</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<p>Optimized Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jax_supernovae.salt3</span><span class="w"> </span><span class="kn">import</span> <span class="n">precompute_bandflux_bridge</span><span class="p">,</span> <span class="n">optimized_salt3_bandflux</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jax_supernovae.bandpasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">register_bandpass</span><span class="p">,</span> <span class="n">Bandpass</span>

<span class="c1"># Enable float64 precision</span>
<span class="n">jax</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;jax_enable_x64&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create a bandpass</span>
<span class="n">wave</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">4000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">trans</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">wave</span><span class="p">)</span>
<span class="n">bandpass</span> <span class="o">=</span> <span class="n">Bandpass</span><span class="p">(</span><span class="n">wave</span><span class="o">=</span><span class="n">wave</span><span class="p">,</span> <span class="n">trans</span><span class="o">=</span><span class="n">trans</span><span class="p">)</span>

<span class="c1"># Precompute bridge data</span>
<span class="n">bridge</span> <span class="o">=</span> <span class="n">precompute_bandflux_bridge</span><span class="p">(</span><span class="n">bandpass</span><span class="p">)</span>

<span class="c1"># Define SALT3 parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;t0&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s1">&#39;x0&#39;</span><span class="p">:</span> <span class="mf">1e-5</span><span class="p">,</span>
    <span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="p">}</span>

<span class="c1"># Compute bandflux using optimized function</span>
<span class="n">time</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">flux</span> <span class="o">=</span> <span class="n">optimized_salt3_bandflux</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">bridge</span><span class="p">[</span><span class="s1">&#39;wave&#39;</span><span class="p">],</span> <span class="n">bridge</span><span class="p">[</span><span class="s1">&#39;dwave&#39;</span><span class="p">],</span> <span class="n">bridge</span><span class="p">[</span><span class="s1">&#39;trans&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<p>Multiple Bands Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jax_supernovae.salt3</span><span class="w"> </span><span class="kn">import</span> <span class="n">precompute_bandflux_bridge</span><span class="p">,</span> <span class="n">optimized_salt3_multiband_flux</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jax_supernovae.bandpasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">register_bandpass</span><span class="p">,</span> <span class="n">Bandpass</span>

<span class="c1"># Enable float64 precision</span>
<span class="n">jax</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;jax_enable_x64&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create bandpasses</span>
<span class="n">bandpasses</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">center</span> <span class="ow">in</span> <span class="p">[(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="mi">4700</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="mi">6200</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="mi">7600</span><span class="p">)]:</span>
    <span class="n">wave</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">center</span> <span class="o">-</span> <span class="mi">500</span><span class="p">,</span> <span class="n">center</span> <span class="o">+</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">trans</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">((</span><span class="n">wave</span> <span class="o">-</span> <span class="n">center</span><span class="p">)</span> <span class="o">/</span> <span class="mi">200</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">bandpass</span> <span class="o">=</span> <span class="n">Bandpass</span><span class="p">(</span><span class="n">wave</span><span class="o">=</span><span class="n">wave</span><span class="p">,</span> <span class="n">trans</span><span class="o">=</span><span class="n">trans</span><span class="p">)</span>
    <span class="n">register_bandpass</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">bandpass</span><span class="p">)</span>
    <span class="n">bandpasses</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">bandpass</span>

<span class="c1"># Precompute bridge data</span>
<span class="n">bridges</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">precompute_bandflux_bridge</span><span class="p">(</span><span class="n">bp</span><span class="p">)</span> <span class="k">for</span> <span class="n">bp</span> <span class="ow">in</span> <span class="n">bandpasses</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

<span class="c1"># Define observation times and band indices</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span>
<span class="n">band_indices</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>  <span class="c1"># 0=g, 1=r, 2=i</span>

<span class="c1"># Define SALT3 parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;t0&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s1">&#39;x0&#39;</span><span class="p">:</span> <span class="mf">1e-5</span><span class="p">,</span>
    <span class="s1">&#39;x1&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="p">}</span>

<span class="c1"># Compute fluxes for all observations</span>
<span class="n">fluxes</span> <span class="o">=</span> <span class="n">optimized_salt3_multiband_flux</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">bridges</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

<span class="c1"># Extract fluxes for each observation</span>
<span class="n">observation_fluxes</span> <span class="o">=</span> <span class="n">fluxes</span><span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)),</span> <span class="n">band_indices</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="bandpasses.html" class="btn btn-neutral float-right" title="Bandpasses Module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Samuel Alan Kossoff Leeney.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 
<script>
  // Add any custom JavaScript here
</script>


</body>
</html>